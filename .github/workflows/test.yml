name: Test and Validate

# Trigger this workflow on pull r          if awk "BEGIN {exit !($COVERAGE_NUM > 0)}"; then
            echo "✅ Coverage check passed: $COVERAGE_NUM% > 0%"
          else
            echo "❌ Coverage check failed: $COVERAGE_NUM% is not greater than 0%"
            exit 1
          fi

  # Add more jobs here for back-end testing when neededs to main branch
on:
  pull_request:
    branches: [main]
  push:
    branches: [main]

jobs:
  test-frontend:
    runs-on: ubuntu-latest

    steps:
      # Checkout the code
      - name: Checkout code
        uses: actions/checkout@v4

      # Setup Node.js environment
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "18"
          cache: "npm"
          cache-dependency-path: front-end/package-lock.json

      # Install dependencies
      - name: Install dependencies
        working-directory: ./front-end
        run: npm ci

      # Run linting
      - name: Run ESLint
        working-directory: ./front-end
        run: npm run lint

      # Build the project
      - name: Build project
        working-directory: ./front-end
        run: npm run build

      # Run tests with coverage
      - name: Run tests with coverage
        working-directory: ./front-end
        run: npm test -- --coverage

      # Check test coverage percentage
      - name: Check coverage percentage
        working-directory: ./front-end
        run: |
          # Extract coverage percentage from the text output
          COVERAGE=$(npm test -- --coverage --run 2>&1 | grep "All files" | awk '{print $4}' | head -1)
          echo "Coverage percentage found: $COVERAGE%"

          # Remove % sign if present and check if it's a number
          COVERAGE_NUM=$(echo $COVERAGE | sed 's/%//g')

          # Check if coverage is greater than 0 using awk for floating point comparison
          if awk "BEGIN {exit !($COVERAGE_NUM > 0)}"; then
            echo "Coverage check passed: $COVERAGE_NUM% > 0%"
          else
            echo "Coverage check failed: $COVERAGE_NUM% is not greater than 0%"
            exit 1
          fi  # Add more jobs here for back-end testing when needed
  # test-backend:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v4
  #     # Add back-end testing steps here
